<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Chat Room</title>
	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
	<!-- Custom CSS -->
	<link rel="stylesheet" href="style.css">
	<!-- Bootstrap Icons -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Roboto:wght@400;700&display=swap"
		rel="stylesheet">
</head>

<body class="bg-gradient ">

	<div class="container-fluid h-100 bg-light mt-1">
		<div class="row h-100">

			<!-- Left Side: Chat Room -->
			<div class="col-lg-8 col-md-8">
				<div class="card shadow-lg h-100">
					<div class="card-body p-4">
						<h3 class="text-center mb-4 font-style">
							<b class="welcome-text">Welcome to</b>
							<span class="brand-name">Interaction Island</span>
						</h3>
						<div id="name-form">
							<div class="input-group mb-3">
								<input type="text" class="form-control" placeholder="Enter your name" id="name-value"
									autofocus>
									<button class="btn btn-primary px-4" id="login">
									    <i class="bi bi-box-arrow-in-right me-2"></i> 
									    Enter
									</button>
							</div>
						</div>
						<div id="chat-room" class="d-none">
							<div class="d-flex justify-content-between align-items-center mb-3">
								<h5 id="name-title" class="font-style welcome-user-msg"></h5>
								<button class="btn btn-danger px-4" id="logout">
								    <i class="bi bi-box-arrow-left me-2"></i>
								    Logout
								</button>
							</div>
							<hr>
							<div class="row">
								<div class="col-12">
									<div id="message-container" class="overflow-auto" style="height: 350px;">
										<!-- Messages will be displayed here -->
									</div>
									<div class="input-group mt-3">
										<input type="text" class="form-control" placeholder="Enter your message"
											id="message-value" autofocus>
											<button class="btn btn-primary px-4" id="send">
											    <i class="bi bi-telegram me-2"></i>
											    Send
											</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Right Side: Coming Soon -->
			<div class="col-md-6 col-lg-5 col-xl-4 bg-light p-3">
				<div class="p-3">

					<div class="input-group rounded mb-3">
						<input type="search" class="form-control rounded" placeholder="Search" aria-label="Search"
							aria-describedby="search-addon" />
						<span class="input-group-text border-0" id="search-addon">
							<i class="fas fa-search"></i>
						</span>
					</div>

					<div data-mdb-perfect-scrollbar-init style="position: relative; height: 100%">
						<ul class="list-unstyled mb-0">
							<li class="p-2 border-bottom">
								<a href="#!" class="d-flex justify-content-between">
									<div class="d-flex flex-row">
										<div>
											<img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava1-bg.webp"
												alt="avatar" class="d-flex align-self-center me-3" width="60">
											<span class="badge bg-success badge-dot"></span>
										</div>
										<div class="pt-1">
											<p class="fw-bold mb-0">Marie Horwitz</p>
											<p class="small text-muted">Hey, how's it going?</p>
										</div>
									</div>
									<div class="pt-1">
										<p class="small text-muted mb-1">Just now</p>
										<span class="badge bg-danger rounded-pill float-end">3</span>
									</div>
								</a>
							</li>
							<li class="p-2 border-bottom">
								<a href="#!" class="d-flex justify-content-between">
									<div class="d-flex flex-row">
										<div>
											<img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava2-bg.webp"
												alt="avatar" class="d-flex align-self-center me-3" width="60">
											<span class="badge bg-warning badge-dot"></span>
										</div>
										<div class="pt-1">
											<p class="fw-bold mb-0">Alexa Chung</p>
											<p class="small text-muted">Hey, did you finish that task?</p>
										</div>
									</div>
									<div class="pt-1">
										<p class="small text-muted mb-1">5 mins ago</p>
										<span class="badge bg-danger rounded-pill float-end">2</span>
									</div>
								</a>
							</li>
							<li class="p-2 border-bottom">
								<a href="#!" class="d-flex justify-content-between">
									<div class="d-flex flex-row">
										<div>
											<img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3-bg.webp"
												alt="avatar" class="d-flex align-self-center me-3" width="60">
											<span class="badge bg-success badge-dot"></span>
										</div>
										<div class="pt-1">
											<p class="fw-bold mb-0">Mark Davis</p>
											<p class="small text-muted">Let's catch up this weekend!</p>
										</div>
									</div>
									<div class="pt-1">
										<p class="small text-muted mb-1">Yesterday</p>
									</div>
								</a>
							</li>
							<li class="p-2 border-bottom">
								<a href="#!" class="d-flex justify-content-between">
									<div class="d-flex flex-row">
										<div>
											<img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava4-bg.webp"
												alt="avatar" class="d-flex align-self-center me-3" width="60">
											<span class="badge bg-danger badge-dot"></span>
										</div>
										<div class="pt-1">
											<p class="fw-bold mb-0">Ashley Olsen</p>
											<p class="small text-muted">Got any plans for the summer?</p>
										</div>
									</div>
									<div class="pt-1">
										<p class="small text-muted mb-1">Yesterday</p>
									</div>
								</a>
							</li>
							<li class="p-2 border-bottom">
								<a href="#!" class="d-flex justify-content-between">
									<div class="d-flex flex-row">
										<div>
											<img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava5-bg.webp"
												alt="avatar" class="d-flex align-self-center me-3" width="60">
											<span class="badge bg-warning badge-dot"></span>
										</div>
										<div class="pt-1">
											<p class="fw-bold mb-0">Kate Moss</p>
											<p class="small text-muted">Let's discuss the project details.</p>
										</div>
									</div>
									<div class="pt-1">
										<p class="small text-muted mb-1">Yesterday</p>
									</div>
								</a>
							</li>
							<li class="p-2">
								<a href="#!" class="d-flex justify-content-between">
									<div class="d-flex flex-row">
										<div>
											<img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava6-bg.webp"
												alt="avatar" class="d-flex align-self-center me-3" width="60">
											<span class="badge bg-success badge-dot"></span>
										</div>
										<div class="pt-1">
											<p class="fw-bold mb-0">Ben Smith</p>
											<p class="small text-muted">Good Morning Subham</p>
										</div>
									</div>
									<div class="pt-1">
										<p class="small text-muted mb-1">Yesterday</p>
									</div>
								</a>
							</li>
						</ul>
					</div>

				</div>
			</div>
<!--Footer Start-->
<!-- Remove the container if you want to extend the Footer to full width. -->
<div class="container mt-1">
  <!-- Footer -->
  <footer
          class="text-center text-lg-start text-dark"
          style="background-color: #ECEFF1"
          >
    <!-- Section: Social media -->
    <section
             class="d-flex justify-content-between p-1 rounded text-white custom-footer"
             style="background-color: #00adb5;"
             >
      <!-- Left -->
	  <div class="text-center p-1 rounded">
	  	  	  <span>© 2022 All rights reserved. Designed with ❤️ by </span>
	  	  	  <a class="text-white author-name" href="https://www.linkedin.com/in/subhamdreamchaser">Subham</a>
	  	  	</div>
      <!-- Left -->
	  <!--Center-->
	  
		<!--Center-->
      <!-- Right -->
      <div>
        <a href="" class="text-white me-4">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href="" class="text-white me-4">
          <i class="fab fa-twitter"></i>
        </a>
        <a href="" class="text-white me-4">
          <i class="fab fa-google"></i>
        </a>
        <a href="" class="text-white me-4">
          <i class="fab fa-instagram"></i>
        </a>
        <a href="https://www.linkedin.com/in/subhamdreamchaser" class="text-white me-4">
          <i class="fab fa-linkedin"></i>
        </a>
        <a href="https://github.com/APPPYYY" class="text-white me-4">
          <i class="fab fa-github"></i>
        </a>
      </div>
      <!-- Right -->
    </section>
  </footer>
  <!-- Footer -->
</div>
<!-- End of .container -->
<!--Footer End-->
		</div>
		
	</div>

	<!-- JavaScript -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
	<script>
		var stompClient = null;

		function connect() {
			let socket = new SockJS("/server1");
			stompClient = Stomp.over(socket);
			stompClient.connect({}, function (frame) {
				console.log('Connected :' + frame);
				$('#name-form').addClass('d-none');
				$('#chat-room').removeClass('d-none');
				stompClient.subscribe('/topic/return-to', function (response) {
					showMessage(JSON.parse(response.body));
				});
			});
		}

		function showMessage(message) {
			$('#message-container').append(`
            <div class="chat-message mb-3">
                <div class="message-header d-flex justify-content-between align-items-center">
                    <strong class="message-author">${message.name}</strong>
                    <span class="message-time">${message.time}</span>
                </div>
                <p class="message-content">${message.content}</p>
            </div>
        `);
			// Auto scroll to bottom
			$('#message-container').scrollTop($('#message-container')[0].scrollHeight);
		}

		function sendMessage() {
			let currentDate = new Date();
			let formattedTime = currentDate.toLocaleTimeString(); // Format: HH:MM:SS AM/PM
			let jsonOb = {
				name: localStorage.getItem('name'),
				content: $('#message-value').val(),
				time: formattedTime
			};
			stompClient.send('/app/message', {}, JSON.stringify(jsonOb));
			// Clear message input after sending
			$('#message-value').val('');
		}

		$(document).ready(() => {
			$('#login').click(() => {
				let name = $('#name-value').val().trim();
				if (name !== '') {
					localStorage.setItem('name', name);
					$('#name-title').html(`Welcome, <span class="text-primary">${name}</span>`);
					connect();
				} else {
					alert('Please enter your name!');
				}
			});

			$('#send').click(() => {
				sendMessage();
			});

			$('#logout').click(() => {
				localStorage.removeItem('name');
				if (stompClient !== null) {
					stompClient.disconnect();
					$('#chat-room').addClass('d-none');
					$('#name-form').removeClass('d-none');
				}
			});

			// Submit message on pressing Enter key
			$('#message-value').keypress((e) => {
				if (e.which === 13) {
					sendMessage();
				}
			});
		});
	</script>

</body>

</html>